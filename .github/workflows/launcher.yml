on:
  release:
    types:
      - prereleased

jobs:
  launch:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Replace RELEASE_TAG_PLACEHOLDER in pipeline.yml
      run: |
        sed -i "s/RELEASE_TAG_PLACEHOLDER/${{  github.ref_name }}/g" .github/workflows/pipeline.yml
        cat .github/workflows/pipeline.yml

    - name: Trigger pipeline.yml workflow
      run: gh workflow run .github/workflows/pipeline.yml -R $GITHUB_REPOSITORY"
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}